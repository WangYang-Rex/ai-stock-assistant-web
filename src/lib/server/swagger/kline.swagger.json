{
  "swagger": "2.0",
  "info": {
    "title": "K-line API",
    "description": "API for managing and retrieving K-line data",
    "version": "1.0.0"
  },
  "basePath": "/",
  "tags": [
    {
      "name": "K-lines",
      "description": "K-line data operations"
    }
  ],
  "paths": {
    "/api/klines/sync": {
      "post": {
        "tags": [
          "K-lines"
        ],
        "summary": "同步K线数据",
        "description": "从外部API获取K线数据并同步到本地数据库（存在则更新，不存在则新增）",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/SyncKlinesDto"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "同步成功",
            "schema": {
              "$ref": "#/definitions/SyncKlinesResponse"
            }
          }
        }
      }
    },
    "/api/klines/list": {
      "post": {
        "tags": [
          "K-lines"
        ],
        "summary": "查询K线数据列表",
        "description": "分页查询本地数据库中的K线数据",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/ListKlinesDto"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "查询成功",
            "schema": {
              "$ref": "#/definitions/ListKlinesResponse"
            }
          }
        }
      }
    },
    "/api/klines/stats": {
      "post": {
        "tags": [
          "K-lines"
        ],
        "summary": "获取K线统计信息",
        "description": "获取指定股票在特定周期下的K线统计数据",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/KlineStatsDto"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "schema": {
              "type": "object",
              "properties": {
                "success": {
                  "type": "boolean"
                },
                "message": {
                  "type": "string"
                },
                "result": {
                  "type": "integer"
                },
                "data": {
                  "type": "object"
                }
              }
            }
          }
        }
      }
    }
  },
  "definitions": {
    "SyncKlinesDto": {
      "type": "object",
      "required": [
        "code"
      ],
      "properties": {
        "code": {
          "type": "string",
          "description": "股票代码 (如 600519)"
        },
        "period": {
          "type": "string",
          "description": "K线周期",
          "enum": [
            "daily",
            "weekly",
            "monthly",
            "1min",
            "5min",
            "15min",
            "30min",
            "60min"
          ],
          "default": "daily"
        },
        "fqType": {
          "type": "integer",
          "description": "复权类型 (0=不复权, 1=前复权, 2=后复权)",
          "enum": [
            0,
            1,
            2
          ],
          "default": 1
        },
        "limit": {
          "type": "integer",
          "description": "获取数据条数限制",
          "default": 1000
        },
        "startDate": {
          "type": "string",
          "description": "开始日期 (YYYYMMDD格式)"
        },
        "endDate": {
          "type": "string",
          "description": "结束日期 (YYYYMMDD格式)"
        }
      }
    },
    "ListKlinesDto": {
      "type": "object",
      "required": [
        "code"
      ],
      "properties": {
        "code": {
          "type": "string",
          "description": "股票代码"
        },
        "period": {
          "type": "integer",
          "description": "K线周期 (101=日线, 102=周线, 103=月线, 1/5/15/30/60=分钟线)",
          "default": 101
        },
        "startDate": {
          "type": "string",
          "description": "开始日期 (YYYY-MM-DD)"
        },
        "endDate": {
          "type": "string",
          "description": "结束日期 (YYYY-MM-DD)"
        },
        "page": {
          "type": "integer",
          "description": "页码",
          "default": 1
        },
        "limit": {
          "type": "integer",
          "description": "每页数量",
          "default": 100
        },
        "orderBy": {
          "type": "string",
          "description": "排序方式",
          "enum": [
            "ASC",
            "DESC"
          ],
          "default": "DESC"
        }
      }
    },
    "KlineStatsDto": {
      "type": "object",
      "required": [
        "code"
      ],
      "properties": {
        "code": {
          "type": "string",
          "description": "股票代码"
        },
        "period": {
          "type": "integer",
          "description": "K线周期",
          "default": 101
        }
      }
    },
    "Kline": {
      "type": "object",
      "properties": {
        "id": {
          "type": "integer"
        },
        "code": {
          "type": "string",
          "description": "股票代码"
        },
        "name": {
          "type": "string",
          "description": "股票名称"
        },
        "period": {
          "type": "integer",
          "description": "K线周期"
        },
        "date": {
          "type": "string",
          "description": "日期时间"
        },
        "open": {
          "type": "number",
          "description": "开盘价"
        },
        "close": {
          "type": "number",
          "description": "收盘价"
        },
        "high": {
          "type": "number",
          "description": "最高价"
        },
        "low": {
          "type": "number",
          "description": "最低价"
        },
        "volume": {
          "type": "string",
          "description": "成交量(股)"
        },
        "amount": {
          "type": "number",
          "description": "成交额(元)"
        },
        "amplitude": {
          "type": "number",
          "description": "振幅(%)"
        },
        "pct": {
          "type": "number",
          "description": "涨跌幅(%)"
        },
        "change": {
          "type": "number",
          "description": "涨跌额"
        },
        "turnover": {
          "type": "number",
          "description": "换手率(%)"
        },
        "fqType": {
          "type": "integer",
          "description": "复权类型"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time"
        }
      }
    },
    "SyncKlinesResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean"
        },
        "message": {
          "type": "string"
        },
        "result": {
          "type": "integer"
        },
        "data": {
          "type": "object",
          "properties": {
            "synced": {
              "type": "integer"
            },
            "total": {
              "type": "integer"
            }
          }
        }
      }
    },
    "ListKlinesResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean"
        },
        "message": {
          "type": "string"
        },
        "result": {
          "type": "integer"
        },
        "data": {
          "type": "object",
          "properties": {
            "data": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Kline"
              }
            },
            "total": {
              "type": "integer"
            },
            "page": {
              "type": "integer"
            },
            "limit": {
              "type": "integer"
            }
          }
        }
      }
    }
  }
}
