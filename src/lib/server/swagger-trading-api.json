{
  "swagger": "2.0",
  "info": {
    "title": "AI Stock Assistant - Trading API",
    "description": "交易记录管理 API 接口文档",
    "version": "1.0.0",
    "contact": {
      "name": "API Support"
    }
  },
  "host": "localhost:3000",
  "basePath": "/",
  "schemes": [
    "http",
    "https"
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "tags": [
    {
      "name": "trading",
      "description": "交易记录相关接口"
    }
  ],
  "paths": {
    "/trading/create": {
      "post": {
        "tags": [
          "trading"
        ],
        "summary": "创建交易记录",
        "description": "创建单条交易记录",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "交易记录数据",
            "required": true,
            "schema": {
              "$ref": "#/definitions/TradingInput"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "创建成功",
            "schema": {
              "$ref": "#/definitions/ApiResponse"
            }
          },
          "400": {
            "description": "请求参数错误"
          },
          "500": {
            "description": "服务器内部错误"
          }
        }
      }
    },
    "/trading/create-batch": {
      "post": {
        "tags": [
          "trading"
        ],
        "summary": "批量创建交易记录",
        "description": "批量创建多条交易记录",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "交易记录数据列表",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "tradingDataList": {
                  "type": "array",
                  "items": {
                    "$ref": "#/definitions/TradingInput"
                  }
                }
              },
              "required": [
                "tradingDataList"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "批量创建成功",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Trading"
              }
            }
          },
          "400": {
            "description": "请求参数错误"
          },
          "500": {
            "description": "服务器内部错误"
          }
        }
      }
    },
    "/trading/list": {
      "post": {
        "tags": [
          "trading"
        ],
        "summary": "获取所有交易记录",
        "description": "获取所有交易记录列表,按交易时间降序排列",
        "responses": {
          "200": {
            "description": "查询成功",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Trading"
              }
            }
          },
          "500": {
            "description": "服务器内部错误"
          }
        }
      }
    },
    "/trading/get-by-symbol": {
      "post": {
        "tags": [
          "trading"
        ],
        "summary": "根据股票代码获取交易记录",
        "description": "查询指定股票代码的所有交易记录",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "股票代码",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "symbol": {
                  "type": "string",
                  "description": "股票代码",
                  "example": "600519"
                }
              },
              "required": [
                "symbol"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "查询成功",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Trading"
              }
            }
          },
          "400": {
            "description": "请求参数错误"
          },
          "500": {
            "description": "服务器内部错误"
          }
        }
      }
    },
    "/trading/get-by-symbol-and-time": {
      "post": {
        "tags": [
          "trading"
        ],
        "summary": "根据股票代码和时间范围获取交易记录",
        "description": "查询指定股票在指定时间范围内的交易记录",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "查询条件",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "symbol": {
                  "type": "string",
                  "description": "股票代码",
                  "example": "600519"
                },
                "startTime": {
                  "type": "string",
                  "format": "date-time",
                  "description": "开始时间",
                  "example": "2024-01-01T00:00:00Z"
                },
                "endTime": {
                  "type": "string",
                  "format": "date-time",
                  "description": "结束时间",
                  "example": "2024-12-31T23:59:59Z"
                }
              },
              "required": [
                "symbol",
                "startTime",
                "endTime"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "查询成功",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Trading"
              }
            }
          },
          "400": {
            "description": "请求参数错误"
          },
          "500": {
            "description": "服务器内部错误"
          }
        }
      }
    },
    "/trading/get-by-type": {
      "post": {
        "tags": [
          "trading"
        ],
        "summary": "根据交易类型获取记录",
        "description": "查询指定类型(买入/卖出)的所有交易记录",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "交易类型",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "enum": [
                    "buy",
                    "sell"
                  ],
                  "description": "交易类型",
                  "example": "buy"
                }
              },
              "required": [
                "type"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "查询成功",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Trading"
              }
            }
          },
          "400": {
            "description": "请求参数错误"
          },
          "500": {
            "description": "服务器内部错误"
          }
        }
      }
    },
    "/trading/get-by-price-range": {
      "post": {
        "tags": [
          "trading"
        ],
        "summary": "根据价格范围获取记录",
        "description": "查询指定价格区间内的所有交易记录",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "价格范围",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "minPrice": {
                  "type": "number",
                  "format": "double",
                  "description": "最低价格",
                  "example": 100.00
                },
                "maxPrice": {
                  "type": "number",
                  "format": "double",
                  "description": "最高价格",
                  "example": 200.00
                }
              },
              "required": [
                "minPrice",
                "maxPrice"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "查询成功",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Trading"
              }
            }
          },
          "400": {
            "description": "请求参数错误"
          },
          "500": {
            "description": "服务器内部错误"
          }
        }
      }
    },
    "/trading/get-latest": {
      "post": {
        "tags": [
          "trading"
        ],
        "summary": "获取最新交易记录",
        "description": "获取最新的交易记录,可指定股票代码和数量限制",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "查询条件",
            "required": false,
            "schema": {
              "type": "object",
              "properties": {
                "symbol": {
                  "type": "string",
                  "description": "股票代码(可选)",
                  "example": "600519"
                },
                "limit": {
                  "type": "integer",
                  "description": "返回记录数量限制,默认100",
                  "example": 100,
                  "default": 100
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "查询成功",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Trading"
              }
            }
          },
          "500": {
            "description": "服务器内部错误"
          }
        }
      }
    },
    "/trading/stats": {
      "post": {
        "tags": [
          "trading"
        ],
        "summary": "获取交易统计信息",
        "description": "获取交易统计数据,包括总交易次数、总成交量、总金额等",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "统计条件",
            "required": false,
            "schema": {
              "type": "object",
              "properties": {
                "symbol": {
                  "type": "string",
                  "description": "股票代码(可选)",
                  "example": "600519"
                },
                "startTime": {
                  "type": "string",
                  "format": "date-time",
                  "description": "开始时间(可选)",
                  "example": "2024-01-01T00:00:00Z"
                },
                "endTime": {
                  "type": "string",
                  "format": "date-time",
                  "description": "结束时间(可选)",
                  "example": "2024-12-31T23:59:59Z"
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "统计成功",
            "schema": {
              "$ref": "#/definitions/TradingStats"
            }
          },
          "500": {
            "description": "服务器内部错误"
          }
        }
      }
    },
    "/trading/update": {
      "post": {
        "tags": [
          "trading"
        ],
        "summary": "更新交易记录",
        "description": "根据ID更新指定交易记录的信息",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "更新数据",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "integer",
                  "description": "交易记录ID",
                  "example": 1
                },
                "updateData": {
                  "$ref": "#/definitions/TradingInput"
                }
              },
              "required": [
                "id",
                "updateData"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "更新成功",
            "schema": {
              "$ref": "#/definitions/Trading"
            }
          },
          "400": {
            "description": "请求参数错误"
          },
          "404": {
            "description": "记录不存在"
          },
          "500": {
            "description": "服务器内部错误"
          }
        }
      }
    },
    "/trading/delete": {
      "post": {
        "tags": [
          "trading"
        ],
        "summary": "删除交易记录",
        "description": "根据ID删除指定的交易记录",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "交易记录ID",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "integer",
                  "description": "交易记录ID",
                  "example": 1
                }
              },
              "required": [
                "id"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功",
            "schema": {
              "type": "object",
              "properties": {
                "success": {
                  "type": "boolean",
                  "description": "是否删除成功"
                }
              }
            }
          },
          "400": {
            "description": "请求参数错误"
          },
          "404": {
            "description": "记录不存在"
          },
          "500": {
            "description": "服务器内部错误"
          }
        }
      }
    },
    "/trading/clean-old-data": {
      "post": {
        "tags": [
          "trading"
        ],
        "summary": "清理过期数据",
        "description": "清理指定天数之前的交易记录",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "保留天数",
            "required": false,
            "schema": {
              "type": "object",
              "properties": {
                "daysToKeep": {
                  "type": "integer",
                  "description": "保留最近N天的数据,默认30天",
                  "example": 30,
                  "default": 30
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "清理成功",
            "schema": {
              "type": "object",
              "properties": {
                "deletedCount": {
                  "type": "integer",
                  "description": "已删除的记录数量"
                },
                "message": {
                  "type": "string",
                  "description": "操作结果消息"
                }
              }
            }
          },
          "500": {
            "description": "服务器内部错误"
          }
        }
      }
    }
  },
  "definitions": {
    "Trading": {
      "type": "object",
      "required": [
        "symbol",
        "name",
        "type",
        "tradingTime",
        "quantity",
        "price",
        "amount"
      ],
      "properties": {
        "id": {
          "type": "integer",
          "description": "交易记录ID",
          "example": 1
        },
        "symbol": {
          "type": "string",
          "description": "股票代码",
          "example": "600519"
        },
        "name": {
          "type": "string",
          "description": "股票名称",
          "example": "贵州茅台"
        },
        "type": {
          "type": "string",
          "enum": [
            "buy",
            "sell"
          ],
          "description": "交易类型",
          "example": "buy"
        },
        "tradingTime": {
          "type": "string",
          "format": "date-time",
          "description": "成交时间",
          "example": "2024-01-10T09:30:00Z"
        },
        "quantity": {
          "type": "integer",
          "format": "int64",
          "description": "交易数量(股)",
          "example": 100
        },
        "price": {
          "type": "number",
          "format": "double",
          "description": "成交价格",
          "example": 1680.50
        },
        "amount": {
          "type": "number",
          "format": "double",
          "description": "交易金额(成交价格×数量)",
          "example": 168050.00
        },
        "relatedTradingId": {
          "type": "integer",
          "description": "关联交易ID(用于关联买入和卖出交易)",
          "example": 2
        },
        "remarks": {
          "type": "string",
          "description": "备注",
          "example": "止盈卖出"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "创建时间"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time",
          "description": "更新时间"
        }
      }
    },
    "TradingInput": {
      "type": "object",
      "required": [
        "symbol",
        "name",
        "type",
        "tradingTime",
        "quantity",
        "price",
        "amount"
      ],
      "properties": {
        "symbol": {
          "type": "string",
          "description": "股票代码",
          "example": "600519"
        },
        "name": {
          "type": "string",
          "description": "股票名称",
          "example": "贵州茅台"
        },
        "type": {
          "type": "string",
          "enum": [
            "buy",
            "sell"
          ],
          "description": "交易类型",
          "example": "buy"
        },
        "tradingTime": {
          "type": "string",
          "format": "date-time",
          "description": "成交时间",
          "example": "2024-01-10T09:30:00Z"
        },
        "quantity": {
          "type": "integer",
          "format": "int64",
          "description": "交易数量(股)",
          "example": 100
        },
        "price": {
          "type": "number",
          "format": "double",
          "description": "成交价格",
          "example": 1680.50
        },
        "amount": {
          "type": "number",
          "format": "double",
          "description": "交易金额(成交价格×数量)",
          "example": 168050.00
        },
        "relatedTradingId": {
          "type": "integer",
          "description": "关联交易ID(用于关联买入和卖出交易)",
          "example": 2
        },
        "remarks": {
          "type": "string",
          "description": "备注",
          "example": "止盈卖出"
        }
      }
    },
    "TradingStats": {
      "type": "object",
      "properties": {
        "totalTrades": {
          "type": "integer",
          "description": "总交易次数",
          "example": 150
        },
        "totalVolume": {
          "type": "integer",
          "format": "int64",
          "description": "总成交量(股)",
          "example": 15000
        },
        "totalAmount": {
          "type": "number",
          "format": "double",
          "description": "总成交金额",
          "example": 2520750.00
        },
        "buyTrades": {
          "type": "integer",
          "description": "买入交易次数",
          "example": 80
        },
        "sellTrades": {
          "type": "integer",
          "description": "卖出交易次数",
          "example": 70
        },
        "avgPrice": {
          "type": "number",
          "format": "double",
          "description": "平均成交价格",
          "example": 168.05
        }
      }
    },
    "ApiResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean",
          "description": "请求是否成功"
        },
        "message": {
          "type": "string",
          "description": "响应消息"
        },
        "data": {
          "$ref": "#/definitions/Trading"
        }
      }
    }
  }
}