{
  "swagger": "2.0",
  "info": {
    "title": "AI股票助手 API",
    "description": "基于 NestJS 的 AI 股票助手后端服务接口文档。提供股票同步、行情快照、K线分析、交易记录管理及 AI 策略信号等功能。",
    "version": "1.2.0",
    "contact": {
      "name": "AI股票助手开发团队"
    }
  },
  "host": "localhost:3000",
  "basePath": "/",
  "schemes": ["http", "https"],
  "consumes": ["application/json"],
  "produces": ["application/json"],
  "tags": [
    { "name": "健康检查", "description": "系统及数据库运行状态监控" },
    { "name": "股票管理", "description": "股票基础信息同步与管理" },
    { "name": "行情数据", "description": "股票当日分时快照及排行榜" },
    { "name": "K线数据", "description": "历史 K 线数据同步与查询" },
    { "name": "分时数据", "description": "当日及最近 5 日分时趋势数据" },
    { "name": "分钟K线", "description": "高频分钟级行情数据" },
    { "name": "交易记录", "description": "用户交易买卖记录管理" },
    { "name": "策略管理", "description": "综合策略信息与信号查询" },
    { "name": "尾盘战法", "description": "尾盘共振策略评估与回测" },
    { "name": "趋势交易", "description": "规则型趋势交易评估" },
    { "name": "定时任务", "description": "系统自动化任务状态与触发" }
  ],
  "paths": {
    "/api/health": {
      "get": {
        "tags": ["健康检查"],
        "summary": "服务器健康检查",
        "responses": {
          "200": { "description": "成功", "schema": { "$ref": "#/definitions/HealthResponse" } }
        }
      }
    },
    "/api/stocks/sync": {
      "post": {
        "tags": ["股票管理"],
        "summary": "同步股票信息",
        "parameters": [
          { "name": "body", "in": "body", "required": true, "schema": { "type": "object", "properties": { "code": { "type": "string" }, "market": { "type": "integer" } } } }
        ],
        "responses": { "200": { "description": "成功" } }
      }
    },
    "/api/stocks/list": {
      "post": {
        "tags": ["股票管理"],
        "summary": "股票列表",
        "responses": { "200": { "description": "成功" } }
      }
    },
    "/api/stocks/constituents/sync": {
      "post": {
        "tags": ["股票管理"],
        "summary": "同步 ETF 成分股",
        "parameters": [
          { "name": "body", "in": "body", "required": true, "schema": { "type": "object", "properties": { "data": { "type": "array", "items": { "type": "object" } } } } }
        ],
        "responses": { "200": { "description": "成功" } }
      }
    },
    "/api/quotes/latest": {
      "post": {
        "tags": ["行情数据"],
        "summary": "最新行情快照",
        "parameters": [
          { "name": "body", "in": "body", "schema": { "type": "object", "properties": { "code": { "type": "string" } } } }
        ],
        "responses": { "200": { "description": "成功" } }
      }
    },
    "/api/quotes/rankings-gainers": {
      "post": {
        "tags": ["行情数据"],
        "summary": "涨幅排行榜",
        "responses": { "200": { "description": "成功" } }
      }
    },
    "/api/klines/sync": {
      "post": {
        "tags": ["K线数据"],
        "summary": "同步 K 线数据",
        "parameters": [
          { "name": "body", "in": "body", "schema": { "type": "object", "properties": { "code": { "type": "string" }, "period": { "type": "string" } } } }
        ],
        "responses": { "200": { "description": "成功" } }
      }
    },
    "/api/trends/sync-from-api": {
      "post": {
        "tags": ["分时数据"],
        "summary": "同步分时数据",
        "responses": { "200": { "description": "成功" } }
      }
    },
    "/api/market/minute-bar/sync-from-api": {
      "post": {
        "tags": ["分钟K线"],
        "summary": "同步分钟 K 线",
        "responses": { "200": { "description": "成功" } }
      }
    },
    "/api/trading/create": {
      "post": {
        "tags": ["交易记录"],
        "summary": "创建交易记录",
        "responses": { "200": { "description": "成功" } }
      }
    },
    "/api/trading/list": {
      "post": {
        "tags": ["交易记录"],
        "summary": "交易记录列表",
        "responses": { "200": { "description": "成功" } }
      }
    },
    "/api/strategies/detail": {
      "post": {
        "tags": ["策略管理"],
        "summary": "获取策略聚合详情",
        "responses": { "200": { "description": "成功" } }
      }
    },
    "/api/strategies/signals/query": {
      "post": {
        "tags": ["策略管理"],
        "summary": "查询策略信号",
        "responses": { "200": { "description": "成功" } }
      }
    },
    "/api/strategies/close-auction/evaluate": {
      "post": {
        "tags": ["尾盘战法"],
        "summary": "尾盘战法评估",
        "responses": { "200": { "description": "成功" } }
      }
    },
    "/api/strategies/rule-trend/evaluate": {
      "post": {
        "tags": ["趋势交易"],
        "summary": "趋势交易评估",
        "responses": { "200": { "description": "成功" } }
      }
    },
    "/api/scheduler/status": {
      "get": {
        "tags": ["定时任务"],
        "summary": "定时任务状态",
        "responses": { "200": { "description": "成功" } }
      }
    }
  },
  "definitions": {
    "HealthResponse": {
      "type": "object",
      "properties": {
        "status": { "type": "string" },
        "database": { "type": "string" },
        "timestamp": { "type": "string", "format": "date-time" }
      }
    }
  }
}
